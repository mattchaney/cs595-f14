\section{Question 1}

\subsection{Question}
\verbatiminput{q1/q1.txt}

\subsection{Answer}
Each question was answered by using some combination of the existing functions from {\tt recommendations.py} and some functions that were added. All of the tables provided were created using the {\tt tabulate} function (with some minor edits), which is shown in Listing \ref{listing:tab}. All of the code used can be found in Appendix A, which contains Listing \ref{listing:all}.

\lstinputlisting[language=Python, caption={tabulate function}, label=listing:tab, linerange={236-250}, firstnumber={236}]{q1/recommendations.py}

\textbf{1. What 5 movies have the highest average ratings?}\\

Question 1 was solved using the code in Listing \ref{listing:q1}, which utilizes the added {\tt get\_avg} and {\tt get\_top} functions, which are found in Listing \ref{listing:avgtop}. The {\tt get\_avg} function uses the {\tt mean} function from the numpy python library \cite{py:numpy}.

\clearpage

\lstinputlisting[language=Python, caption={Question 1 code}, label=listing:q1, linerange={259-265}, firstnumber={259}]{q1/recommendations.py}

\lstinputlisting[language=Python, caption={get\_avg and get\_top functions}, label=listing:avgtop, linerange={203-221}, firstnumber={203}]{q1/recommendations.py}

The results for Question 1 are shown in Table \ref{tab:hiavgrat}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
They Made Me a Criminal (1939) & 5.0 \\
Someone Else's America (1995) & 5.0 \\
Saint of Fort Washington, The (1993) & 5.0 \\
Entertaining Angels: The Dorothy Day Story (1996) & 5.0 \\
Marlene Dietrich: Shadow and Light (1996)  & 5.0 \\
Star Kid (1997) & 5.0 \\
Aiqing wansui (1994) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Great Day in Harlem, A (1994) & 5.0 \\
Santa with Muscles (1996) & 5.0 \\
\hline
\end{tabular}
\caption{Question 1: Highest Average Rating}
\label{tab:hiavgrat}
\end{table}

\textbf{2. What 5 movies received the most ratings? Show the movies and the number of ratings sorted by number of ratings.}\\

Question 2 was solved using the {\tt count\_movie\_ratings} and {\tt get\_top} functions. The code used is shown in Listings \ref{listing:q2}, \ref{listing:countratings} and \ref{listing:avgtop}.

\clearpage

\lstinputlisting[language=Python, caption={Question 2 code}, label=listing:q2, linerange={267-272}, firstnumber={267}]{q1/recommendations.py}

\lstinputlisting[language=Python, caption={count\_movie\_ratings function}, label=listing:countratings, linerange={223-228}, firstnumber={223}]{q1/recommendations.py}

The results for Question 2 are shown in Table \ref{tab:mratings}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Ratings Count \\
\hline
Star Wars (1977) & 583 \\
Contact (1997) & 509 \\
Fargo (1996) & 508 \\
Return of the Jedi (1983) & 507 \\
Liar Liar (1997) & 485 \\
\hline
\end{tabular}
\caption{Question 2: Most Ratings}
\label{tab:mratings}
\end{table}

\textbf{3. What 5 movies were rated the highest on average by women? Show the movies and their ratings sorted by ratings.}\\

Question 3 was solved using the code in Listing \ref{listing:q3} and the {\tt get\_avg} and {\tt get\_top} functions from Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 3 code}, label=listing:q3, linerange={275-279}, firstnumber={275}]{q1/recommendations.py}

The results of Question 3 are shown in Table \ref{tab:hwratings}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
Stripes (1981) & 5.0 \\
Someone Else's America (1995) & 5.0 \\
Faster Pussycat! Kill! Kill! (1965) & 5.0 \\
Everest (1998) & 5.0 \\
Visitors, The (Visiteurs, Les) (1993) & 5.0 \\
Maya Lin: A Strong Clear Vision (1994) & 5.0 \\
Year of the Horse (1997) & 5.0 \\
Foreign Correspondent (1940) & 5.0 \\
Telling Lies in America (1997) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Mina Tannenbaum (1994) & 5.0 \\
\hline
\end{tabular}
\caption{Question 3: Highest Ratings by Women}
\label{tab:hwratings}
\end{table}

\clearpage

\textbf{4. What 5 movies were rated the highest on average by men? Show the movies and their ratings sorted by ratings.}\\

Question 4 was solved using the code in Listing \ref{listing:q4} and the {\tt get\_avg} and {\tt get\_top} functions from Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 4 code}, label=listing:q4, linerange={281-286}, firstnumber={281}]{q1/recommendations.py}

The results of Question 4 are shown in Table \ref{tab:hmratings}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
They Made Me a Criminal (1939) & 5.0 \\
Letter From Death Row, A (1998) & 5.0 \\
Saint of Fort Washington, The (1993) & 5.0 \\
Quiet Room, The (1996) & 5.0 \\
Entertaining Angels: The Dorothy Day Story (1996) & 5.0 \\
Marlene Dietrich: Shadow and Light (1996)  & 5.0 \\
Star Kid (1997) & 5.0 \\
Little City (1998) & 5.0 \\
Aiqing wansui (1994) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Love Serenade (1996) & 5.0 \\
Leading Man, The (1996) & 5.0 \\
Great Day in Harlem, A (1994) & 5.0 \\
Santa with Muscles (1996) & 5.0 \\
Delta of Venus (1994) & 5.0 \\
\hline
\end{tabular}
\caption{Question 4: Highest Ratings by Men}
\label{tab:hmratings}
\end{table}

\textbf{5. What movie received ratings most like Top Gun?}\\

Question 5 was solved using the code from Listing \ref{listing:q5} and the {\tt get\_sim\_ratings} function from Listing \ref{listing:simratings}.

\lstinputlisting[language=Python, caption={question 5 code}, label=listing:q5, linerange={288-296}, firstnumber={288}]{q1/recommendations.py}

\lstinputlisting[language=Python, caption={get\_sim\_ratings function}, label=listing:simratings, linerange={230-234}, firstnumber={230}]{q1/recommendations.py}

The results for Question 5 are shown in Tables \ref{tab:mltg1}, \ref{tab:mltg2} and \ref{tab:lltg}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Pearson's r & Title \\
\hline
1.0 & Shiloh (1997) \\
1.0 & King of the Hill (1993) \\
1.0 & Bhaji on the Beach (1993) \\
1.0 & Wild America (1997) \\
1.0 & Wedding Gift, The (1994) \\
1.0 & Underground (1995) \\
1.0 & Two or Three Things I Know About Her (1966) \\
1.0 & Two Bits (1995) \\
1.0 & Total Eclipse (1995) \\
1.0 & The Innocent (1994) \\
1.0 & That Old Feeling (1997) \\
1.0 & Stars Fell on Henrietta, The (1995) \\
1.0 & Stalker (1979) \\
1.0 & Spirits of the Dead (Tre passi nel delirio) (1968) \\
1.0 & Show, The (1995) \\
1.0 & Shooter, The (1995) \\
1.0 & Selena (1997) \\
1.0 & Schizopolis (1996) \\
1.0 & Scarlet Letter, The (1926) \\
1.0 & Run of the Country, The (1995) \\
1.0 & Ponette (1996) \\
1.0 & Perfect Candidate, A (1996) \\
1.0 & Outlaw, The (1943) \\
1.0 & Old Lady Who Walked in the Sea, The (Vieille qui marchait dans la mer, La) (1991) \\
1.0 & Nothing to Lose (1994) \\
1.0 & New Jersey Drive (1995) \\
1.0 & Mr. Jones (1993) \\
1.0 & Metisse (Caf√© au Lait) (1993) \\
1.0 & Maybe, Maybe Not (Bewegte Mann, Der) (1994) \\
1.0 & Manny \& Lo (1996) \\
\hline
\end{tabular}
\caption{Question 5: Most like Top Gun}
\label{tab:mltg1}
\end{table}

\clearpage

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Pearson's r & Title \\
\hline
1.0 & Man of the Year (1995) \\
1.0 & Love Serenade (1996) \\
1.0 & Last Time I Saw Paris, The (1954) \\
1.0 & Killer (Bulletproof Heart) (1994) \\
1.0 & Jerky Boys, The (1994) \\
1.0 & I Like It Like That (1994) \\
1.0 & Horse Whisperer, The (1998) \\
1.0 & Hear My Song (1991) \\
1.0 & Grosse Fatigue (1994) \\
1.0 & Gone Fishin' (1997) \\
1.0 & Glass Shield, The (1994) \\
1.0 & Germinal (1993) \\
1.0 & Gabbeh (1996) \\
1.0 & Four Days in September (1997) \\
1.0 & Flower of My Secret, The (Flor de mi secreto, La) (1995) \\
1.0 & Fausto (1993) \\
1.0 & Even Cowgirls Get the Blues (1993) \\
1.0 & Enfer, L' (1994) \\
1.0 & Dream With the Fishes (1997) \\
1.0 & Dream Man (1995) \\
1.0 & Dangerous Ground (1997) \\
1.0 & Collectionneuse, La (1967) \\
1.0 & Clean Slate (Coup de Torchon) (1981) \\
1.0 & Calendar Girl (1993) \\
1.0 & Blood For Dracula (Andy Warhol's Dracula) (1974) \\
1.0 & Bliss (1997) \\
1.0 & Best Men (1997) \\
1.0 & American Dream (1990) \\
1.0 & Albino Alligator (1996) \\
1.0 & 8 Seconds (1994) \\
\hline
\end{tabular}
\caption{Question 5 cont'd: Most like Top Gun}
\label{tab:mltg2}
\end{table}

\clearpage

\textbf{5. cont'd. Which movie received ratings that were least like Top Gun (negative correlation)}\\

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Pearson's r & Title \\
\hline
-1.0 & Babysitter, The (1995) \\
-1.0 & Telling Lies in America (1997) \\
-1.0 & Year of the Horse (1997) \\
-1.0 & World of Apu, The (Apur Sansar) (1959) \\
-1.0 & Two Much (1996) \\
-1.0 & Tetsuo II: Body Hammer (1992) \\
-1.0 & Switchback (1997) \\
-1.0 & Safe Passage (1994) \\
-1.0 & Roseanna's Grave (For Roseanna) (1997) \\
-1.0 & Romper Stomper (1992) \\
-1.0 & Nil By Mouth (1997) \\
-1.0 & Nico Icon (1995) \\
-1.0 & Naked in New York (1994) \\
-1.0 & Midnight Dancers (Sibak) (1994) \\
-1.0 & Meet Wally Sparks (1997) \\
-1.0 & Lover's Knot (1996) \\
-1.0 & Love and Death on Long Island (1997) \\
-1.0 & Loch Ness (1995) \\
-1.0 & Lamerica (1994) \\
-1.0 & Joy Luck Club, The (1993) \\
-1.0 & Heidi Fleiss: Hollywood Madam (1995)  \\
-1.0 & Frisk (1995) \\
-1.0 & Everest (1998) \\
-1.0 & Carried Away (1996) \\
-1.0 & Carpool (1996) \\
-1.0 & Caro Diario (Dear Diary) (1994) \\
-1.0 & Broken English (1996) \\
-1.0 & Bitter Sugar (Azucar Amargo) (1996) \\
-1.0 & Bewegte Mann, Der (1994) \\
-1.0 & Beat the Devil (1954) \\
-1.0 & Bad Moon (1996) \\
\hline
\end{tabular}
\caption{Question 5.5: Least like Top Gun}
\label{tab:lltg}
\end{table}

\textbf{6. Which 5 raters rated the most films? Show the raters' IDs and the number of films each rated.}\\

Question 6 was solved using the code from Listing \ref{listing:q6} and the {\tt get\_top} function shown in Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 6 code}, label=listing:q6, linerange={298-303}, firstnumber={298}]{q1/recommendations.py} 

The results of Question 6 are shown in Table \ref{tab:opinion}.

\clearpage

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Rater ID & Ratings Count \\
\hline
405 & 736 \\
655 & 678 \\
13 & 632 \\
450 & 538 \\
276 & 516 \\
\hline
\end{tabular}
\caption{Question 6: Most Opinionated Viewers}
\label{tab:opinion}
\end{table}

\textbf{7. Which 5 raters most agreed with each other? Show the raters' IDs and Pearson's r, sorted by r.}\\

Question 7 was solved using the code shown in Listing \ref{listing:q7}, with the {\tt calcSimilarUsers} and the {\tt get\_top} functions from Listings \ref{listing:simuser} and \ref{listing:avgtop}, respectively. The {\tt flatten} function from Listing \ref{listing:flatten} was used to flatted the oddly arranged tuple that was created from the {\tt calcSimUsers} function.

\lstinputlisting[language=Python, caption={question 7 code}, label=listing:q7, linerange={305-311}, firstnumber={305}]{q1/recommendations.py}

\lstinputlisting[language=Python, caption={calcSimilarUsers function}, label=listing:simuser, linerange={144-153}, firstnumber={144}]{q1/recommendations.py}

\lstinputlisting[language=Python, caption={flatten function}, label=listing:flatten, linerange={254-255}, firstnumber={254}]{q1/recommendations.py}

The results for Question 7 are shown in Table \ref{tab:band}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l | l |}
\hline
User 1 ID & User 2 ID & Pearson's r \\
\hline
772 & 889 & 1.0 \\
889 & 772 & 1.0 \\
828 & 98 & 1.0 \\
231 & 942 & 1.0 \\
846 & 941 & 1.0 \\
\hline
\end{tabular}
\caption{Question 7: Bandwagoners}
\label{tab:band}
\end{table}

\clearpage

\textbf{8. Which 5 raters most disagreed with each other (negative correlation)? Show the raters' IDs and Pearson's r, sorted by r.}\\

Question 8 was solved using the code from Listing \ref{listing:q8} and the {\tt get\_top} function from Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 8 code}, label=listing:q8, linerange={313-318}, firstnumber={313}]{q1/recommendations.py}

The results for Question 8 are shown in Table \ref{tab:cont}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l | l |}
\hline
User 1 ID & User 2 ID & r Value \\
\hline
655 & 384 & 0.683130051064 \\
13 & 46 & 0.687746384953 \\
130 & 511 & 0.725423370905 \\
327 & 816 & 0.77151674981 \\
796 & 205 & 0.791384015377 \\
\hline
\end{tabular}
\caption{Question 8: Nemeses}
\label{tab:cont}
\end{table}

\textbf{9. What movie was rated highest on average by men over 40?}\\

Question 9 was solved using the code from Listing \ref{listing:q9} with the {\tt get\_avg} and {\tt get\_top} functions from Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 9 code}, label=listing:q9, linerange={320-332}, firstnumber={320}]{q1/recommendations.py}

The results for Question 9 are shown in Tables \ref{tab:hrbom} and \ref{tab:hrbaom}.

\clearpage

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
Aparajito (1956) & 5.0 \\
They Made Me a Criminal (1939) & 5.0 \\
Two or Three Things I Know About Her (1966) & 5.0 \\
Faithful (1996) & 5.0 \\
Ace Ventura: When Nature Calls (1995) & 5.0 \\
Strawberry and Chocolate (Fresa y chocolate) (1993) & 5.0 \\
Indian Summer (1996) & 5.0 \\
Grateful Dead (1995) & 5.0 \\
Boxing Helena (1993) & 5.0 \\
Double Happiness (1994) & 5.0 \\
Poison Ivy II (1995) & 5.0 \\
Spice World (1997) & 5.0 \\
World of Apu, The (Apur Sansar) (1959) & 5.0 \\
Marlene Dietrich: Shadow and Light (1996)  & 5.0 \\
Unstrung Heroes (1995) & 5.0 \\
Star Kid (1997) & 5.0 \\
Little City (1998) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Leading Man, The (1996) & 5.0 \\
Little Princess, The (1939) & 5.0 \\
Great Day in Harlem, A (1994) & 5.0 \\
Late Bloomers (1996) & 5.0 \\
Rendezvous in Paris (Rendez-vous de Paris, Les) (1995) & 5.0 \\
Solo (1996) & 5.0 \\
Hearts and Minds (1996) & 5.0 \\
\hline
\end{tabular}
\caption{Question 9: Highest Ratings by Men aged > 40}
\label{tab:hrbom}
\end{table}

\clearpage

\textbf{9. cont'd. By men under 40?}\\

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
Letter From Death Row, A (1998) & 5.0 \\
Perfect Candidate, A (1996) & 5.0 \\
Saint of Fort Washington, The (1993) & 5.0 \\
Quiet Room, The (1996) & 5.0 \\
Magic Hour, The (1998) & 5.0 \\
Entertaining Angels: The Dorothy Day Story (1996) & 5.0 \\
Maya Lin: A Strong Clear Vision (1994) & 5.0 \\
Angel Baby (1995) & 5.0 \\
Star Kid (1997) & 5.0 \\
Love in the Afternoon (1957) & 5.0 \\
Aiqing wansui (1994) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Love Serenade (1996) & 5.0 \\
Leading Man, The (1996) & 5.0 \\
Crossfire (1947) & 5.0 \\
Santa with Muscles (1996) & 5.0 \\
Delta of Venus (1994) & 5.0 \\
\hline
\end{tabular}
\caption{Question 9.5: Highest Ratings by Men aged < 40}
\label{tab:hrbaom}
\end{table}

\clearpage

\textbf{10. What movie was rated highest on average by women over 40?}\\

Question 10 was solved using the code from Listing \ref{listing:q10} with the {\tt get\_avg} and {\tt get\_top} functions from Listing \ref{listing:avgtop}.

\lstinputlisting[language=Python, caption={question 10 code}, label=listing:q10, linerange={334-346}, firstnumber={334}]{q1/recommendations.py}

The results for Question 10 are shown in Tables \ref{tab:hrbow} and \ref{tab:hrbaow}.

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
Tombstone (1993) & 5.0 \\
Shall We Dance? (1937) & 5.0 \\
Quest, The (1996) & 5.0 \\
Top Hat (1935) & 5.0 \\
Safe (1995) & 5.0 \\
In the Bleak Midwinter (1995) & 5.0 \\
Grand Day Out, A (1992) & 5.0 \\
Letter From Death Row, A (1998) & 5.0 \\
Band Wagon, The (1953) & 5.0 \\
Funny Face (1957) & 5.0 \\
Ma vie en rose (My Life in Pink) (1997) & 5.0 \\
Visitors, The (Visiteurs, Les) (1993) & 5.0 \\
Pocahontas (1995) & 5.0 \\
Angel Baby (1995) & 5.0 \\
Wrong Trousers, The (1993) & 5.0 \\
Best Men (1997) & 5.0 \\
Foreign Correspondent (1940) & 5.0 \\
Swept from the Sea (1997) & 5.0 \\
Mary Shelley's Frankenstein (1994) & 5.0 \\
Shallow Grave (1994) & 5.0 \\
Nightmare Before Christmas, The (1993) & 5.0 \\
Gold Diggers: The Secret of Bear Mountain (1995) & 5.0 \\
Mina Tannenbaum (1994) & 5.0 \\
Bride of Frankenstein (1935) & 5.0 \\
Balto (1995) & 5.0 \\
Great Dictator, The (1940) & 5.0 \\
\hline
\end{tabular}
\caption{Question 10: Highest Ratings by Women aged > 40}
\label{tab:hrbow}
\end{table}

\clearpage

\textbf{10. cont'd. By women under 40?}\\

\begin{table}[h!]
\centering
\begin{tabular}{| l | l |}
\hline
Title & Rating \\
\hline
Stripes (1981) & 5.0 \\
Don't Be a Menace to South Central While Drinking Your Juice in the Hood (1996) & 5.0 \\
Someone Else's America (1995) & 5.0 \\
Grace of My Heart (1996) & 5.0 \\
Horseman on the Roof, The (Hussard sur le toit, Le) (1995) & 5.0 \\
Faster Pussycat! Kill! Kill! (1965) & 5.0 \\
Wedding Gift, The (1994) & 5.0 \\
Heaven's Prisoners (1996) & 5.0 \\
Everest (1998) & 5.0 \\
Nico Icon (1995) & 5.0 \\
Maya Lin: A Strong Clear Vision (1994) & 5.0 \\
Year of the Horse (1997) & 5.0 \\
Umbrellas of Cherbourg, The (Parapluies de Cherbourg, Les) (1964) & 5.0 \\
Telling Lies in America (1997) & 5.0 \\
Prefontaine (1997) & 5.0 \\
Mina Tannenbaum (1994) & 5.0 \\
Backbeat (1993) & 5.0 \\
\hline
\end{tabular}
\caption{Question 10.5: Highest Ratings by Women aged < 40}
\label{tab:hrbaow}
\end{table}

\clearpage

\section{Appendix A}
\lstinputlisting[language=Python, caption={all code used}, label=listing:all]{q1/recommendations.py}